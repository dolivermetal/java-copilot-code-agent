name: üìä Alterar Capacidade de Atividade
description: Aumentar ou diminuir a capacidade m√°xima de participantes de uma atividade
title: "[Capacidade]: "
labels: ["enhancement", "atividade", "capacidade", "copilot"]
assignees:
  - copilot
body:
  - type: markdown
    attributes:
      value: |
        ## üìä Formul√°rio de Altera√ß√£o de Capacidade
        
        Use este formul√°rio para solicitar altera√ß√£o na capacidade m√°xima de uma atividade.
        Esta √© uma solicita√ß√£o comum e simplificada.
        
        **O Copilot ser√° automaticamente designado para implementar esta solicita√ß√£o.**

  - type: input
    id: activity-name
    attributes:
      label: Nome da Atividade *
      description: Nome exato da atividade
      placeholder: "Ex: Art Club"
    validations:
      required: true

  - type: input
    id: current-capacity
    attributes:
      label: Capacidade Atual
      description: (Opcional) Informe a capacidade atual se souber
      placeholder: "20"

  - type: input
    id: new-capacity
    attributes:
      label: Nova Capacidade *
      description: Novo n√∫mero m√°ximo de participantes
      placeholder: "30"
    validations:
      required: true

  - type: dropdown
    id: reason
    attributes:
      label: Motivo da Altera√ß√£o *
      description: Por que a capacidade precisa ser alterada?
      options:
        - Alta demanda - atividade muito popular
        - Novo espa√ßo dispon√≠vel
        - Recursos adicionais (equipamentos, materiais)
        - Redu√ß√£o de espa√ßo/recursos
        - Requisitos de seguran√ßa
        - Propor√ß√£o professor/aluno
        - Outro
    validations:
      required: true

  - type: textarea
    id: justification
    attributes:
      label: Justificativa Detalhada *
      description: Explique em detalhes a necessidade desta altera√ß√£o
      placeholder: "Ex: A atividade tem lista de espera com 15 alunos. Conseguimos um espa√ßo maior que permite acomodar mais estudantes com seguran√ßa."
    validations:
      required: true

  - type: checkboxes
    id: confirmations
    attributes:
      label: Confirma√ß√µes *
      description: Confirme os seguintes pontos
      options:
        - label: Tenho recursos suficientes (espa√ßo, equipamentos, supervis√£o) para a nova capacidade
          required: true
        - label: (Se redu√ß√£o) Confirmo que h√° menos participantes inscritos do que a nova capacidade
          required: false
        - label: Notificarei os estudantes sobre a altera√ß√£o de capacidade
          required: true

  - type: textarea
    id: additional-context
    attributes:
      label: Informa√ß√µes Adicionais
      description: Qualquer outra informa√ß√£o relevante

  - type: markdown
    attributes:
      value: |
        ---
        
        ## ü§ñ Crit√©rios de Aceita√ß√£o para o Copilot
        
        A implementa√ß√£o deve:
        1. Localizar a atividade existente pelo nome exato
        2. Verificar a capacidade atual da atividade
        3. **IMPORTANTE**: Se for redu√ß√£o, validar que o n√∫mero atual de participantes n√£o excede a nova capacidade
        4. Atualizar o campo `maxParticipants` da atividade
        5. Criar uma migra√ß√£o Mongock para aplicar a altera√ß√£o
        6. Verificar que a nova capacidade aparece corretamente na interface web
        7. Garantir que o indicador visual de capacidade reflete a nova capacidade
        
        ## üí° Dicas de Implementa√ß√£o
        
        - Criar nova migra√ß√£o: `V00X_UpdateActivityCapacity_[NomeAtividade].java`
        - Localizar atividade: `mongoTemplate.findOne(Query.query(Criteria.where("name").is(activityName)), Activity.class)`
        - Validar participantes atuais: `activity.getParticipants().size() <= newCapacity`
        - Atualizar capacidade: `activity.setMaxParticipants(newCapacity)`
        - Persistir: `mongoTemplate.save(activity)`
        - Adicionar m√©todo de rollback na migra√ß√£o
        
        ## üîç Contexto T√©cnico
        
        - **Campo**: `Activity.maxParticipants` (tipo: int)
        - **Valida√ß√£o**: M√©todo `validateMaxParticipants()` na classe Activity
        - **Regra**: maxParticipants > 0
        - **Regra cr√≠tica**: N√£o permitir capacidade < n√∫mero atual de participantes
        - **Interface**: O cart√£o de atividade mostra "X inscritos" e "Y vagas restantes"
        
        ## ‚ö†Ô∏è Valida√ß√µes Cr√≠ticas
        
        ```java
        // Verificar antes de reduzir
        if (newCapacity < activity.getCurrentParticipantCount()) {
            throw new IllegalStateException(
                "Cannot reduce capacity below current participant count");
        }
        ```
        
        ## üìã Checklist de Teste
        
        - [ ] Atividade localizada corretamente
        - [ ] Capacidade atualizada no banco
        - [ ] Interface web mostra nova capacidade
        - [ ] Indicador de vagas dispon√≠veis correto
        - [ ] Se aumento: permite novas inscri√ß√µes at√© nova capacidade
        - [ ] Se redu√ß√£o: valida n√∫mero de participantes atuais
